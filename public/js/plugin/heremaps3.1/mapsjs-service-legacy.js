
/**
 * The code below uses open source software. Please visit the URL below for an overview of the licenses:
 * http://js.api.here.com/v3/3.1.12.0/HERE_NOTICE
 */

H.service.util.eval("function Lr(a){var b;if(a)for(this.a={},b=a.length;b--;)this.a[a[b]]=!0;this.Xk={}}var Mr;Lr.prototype.a={};Lr.prototype.parse=function(a,b,c){var d,e,f,g,h;Mr=!1;try{c=Ap.JSON.parse(c)}catch(m){Mr=!0}if(c&&(d=c.metadata)){var k={spatials:[]};for(e in d){if(c=!this.a[e]&&(f=Nr[e]))(g=d[e])||(Mr=!0,g=void 0),c=g;if(c)for(c=g.length;c--;){var l;(l=g[c])||(Mr=!0,l=void 0);(h=l)&&f(b,a,this,e,h,k)}}}else Mr=!0;return Mr?void 0:k};Lr.prototype.parse=Lr.prototype.parse;\nvar Nr={\"street labels\":function(a,b,c,d,e,f){var g;(g=e.vertices)||(Mr=!0,g=void 0);if(g){var h,k=g.length,l;(l=0<k)||(Mr=!0,l=void 0);if(l)for(h=Array(k/2);k;){var m=g[--k];l=g[--k];h[k/2]=new H(l,m)}h=h?{a:[h]}:B;k=+e[\"font size\"]/a.hb();g=c.Xk[k];g||(Or.lineWidth=k,g=c.Xk[k]=c.Gd.xj(Or));Pr(a,b,h,!1,g,e,d,f)}delete e.vertices},\"city center labels\":function(a,b,c,d,e,f){Pr(a,b,Qr(e,new oh([])),!0,c.Gd,e,d,f)},labels:function(a,b,c,d,e,f){var g;(g=e[\"bounding boxes\"])||(Mr=!0,g=void 0);if(g){for(var h=\ng.length,k=new oh([]),l;h--;){var m;(m=g[h])||(Mr=!0,m=void 0);(l=m)&&Qr(l,k)}Pr(a,b,k,!0,c.Gd,e,d,f)}delete e[\"bounding boxes\"]},buildings:function(a,b,c,d,e,f){var g=e.id,h=b.ig[g],k,l,m,q=[],p=[];(k=e)||(Mr=!0,k=void 0);if(k&&((l=k.vertices)||(Mr=!0,l=void 0),l)){var r;(r=k.polygons)||(Mr=!0,r=void 0);(m=r)&&q.push.apply(q,Rr(l,m));(k=k.outlines)||(Mr=!0,k=void 0);(m=k)&&p.push.apply(p,Rr(l,m))}m=q.length;q.push.apply(q,p);p=new oh(q,Sd,m);(q=q.length)||(Mr=!0,q=void 0);q&&(h?(Bq(h,a,[p]),f.spatials.push(h)):\n(h=Pr(a,b,p,!0,c.Gd,e,d,f,g),b.aa(h)))}};Nr[\"transit stops\"]=Nr.POIs=Nr.labels;var Sr=[\"box 2\",\"box 1\",\"annotation box\",\"icon box\"];function Qr(a,b){for(var c=Sr.length,d,e;c--;)if(d=Sr[c],e=a[d]){var f=e[0],g=e[1],h=e[2];e=e[3];b.a.push([new H(f,g),new H(f+h,g),new H(f+h,g+e),new H(f,g+e)]);delete a[d]}return b}\nfunction Rr(a,b){var c=b.length,d,e,f;if(0<c)for(e=Array(c);c--;)if((d=b[c])||(Mr=!0,d=void 0),d){var g=d.length;if(0<g)for(e[c]=f=Array(g);g--;){var h=2*d[g];f[g]=new H(a[h],a[h+1])}}return e||[]}var Tr={};function Pr(a,b,c,d,e,f,g,h,k){Tr.style=e;d=new xq(b,d,k,Tr);c&&Bq(d,a,[c]);Ur(f);f.category=g;d.setData(f);h.spatials.push(d);d.fa(b);return d}Lr.prototype.Gd=new Rg({strokeColor:\"transparent\",fillColor:\"transparent\",lineWidth:0});var Or={};\nfunction Ur(a){var b,c=!1;switch(typeof a){case \"object\":if(a instanceof Array)for(b=a.length;b--;)Ur(a[b])?c=!0:delete a[b];else if(a)for(b in a)Ur(a[b])?c=!0:delete a[b];break;case \"number\":c=!0;break;default:c=!!a}return c};function Vr(a,b,c){c=c||{};b=b||{};var d=c.tileType||\"maptile\",e=c.scheme||\"normal.day\";Q.call(this,{min:0,max:20});!0===b.pois&&(b.pois=\"!F\");this.a=b;if(!(a&&a instanceof Wr))throw Error(\"InvalidArgument: service required\");this.F=a;this.D=A(this.D,this);this.F.addEventListener(\"versionupdate\",this.D);this.b=a.Ja().clone().Y(d+\"/\"+a.Ac()+\"/\"+e).W(this.I).W(b);this.ec=a.ph()||null;this.S=c.pixelRatio||c.pixelratio||Re();this.tileSize=c.tileSize||256;this.tileType=d;this.scheme=e;this.s=new fq(new Lr(c.categoryFilter));\nthis.s.fa(this);this.L=A(this.L,this);this.s.addEventListener(\"update\",this.L);Q.call(this,{min:0,max:20});this.K(new Ck(c.tileCacheSize||256,A(this.ya,this)))}u(Vr,Q);t(\"H.service.metaInfo.TileProvider\",Vr);Vr.prototype.ya=function(a,b){a=b.Wa();for(var c=a.length,d;c--;)d=a[c],delete d.af[b.key],d.release();b.data&&(Dp.push(b.gg(),this.tileSize),b.hg())};Vr.prototype.L=function(){this.dispatchEvent(\"update\")};\nVr.prototype.Ra=function(a,b,c,d,e){var f=this.b.clone(),g=this.ec,h=this.tileSize,k=this.getTileKey(a,b,c);k=this.Tb().get(k);var l;if(k&&!k.Yd()){d(Dp.pop(this.tileSize),null);var m={cancel:function(){}}}else{g&&f.za(g[(c+b+a)%g.length]);f.Y(c+\"/\"+a+\"/\"+b+\"/\"+h+\"/png8\");var q=Ap.setTimeout(function(){l=(new qf(\"text/plain\",f.toString())).then(function(p){d(null,p)},e)},500)}return m||{cancel:function(){l?l.cancel():Ap.clearTimeout(q)}}};Vr.prototype.requestInternal=Vr.prototype.Ra;\nVr.prototype.jd=function(a,b,c,d,e){var f=this.s;var g=d||Dp.pop(this.tileSize);if(d)a=this.Tb().get(this.getTileKey(a,b,c)),a.X(d);else if(d=a=new Nk(this.Vd(a,b,c),a,b,c,this.tileSize,this.S,c,f),delete d.i,d.m=e,a.X(g))for(e=a.Wa(),g=e.length;g--;)e[g].og();else Dp.push(g,this.tileSize);return a};Vr.prototype.createTileInternal=Vr.prototype.jd;Vr.prototype.C=function(){this.s.C();this.F.removeEventListener(\"versionupdate\",this.D);Q.prototype.C.call(this)};\nVr.prototype.D=function(){var a=this.F;this.b=a.Ja().clone().Y(this.tileType+\"/\"+a.Ac()+\"/\"+this.scheme).W(this.I).W(this.a);this.reload(!1)};Vr.prototype.I={metadata:\"metaonly\",mgen:\"2\"};function Wr(a){var b=up({},this.ua,a||{});if(!Wr.ub)throw new Xc(Wr);if(!b.baseUrl&&!b.platformBaseUrl)throw new D(Wr,0,'either \"baseUrl\" or \"platformBaseUrl\" must be specified');F.call(this);this.B=(b.baseUrl?b.baseUrl:b.platformBaseUrl).clone();this.Aa(b.baseUrl?a||{}:b);this.R=b.headers||{};this.ec=b.shards;(this.Sa=b.ignoreTypes?null:b.type)&&this.B.za(this.Sa);this.fc=b.version;this.gi={};this.Uc=new Mp;\"newest\"===this.fc&&this.Zg()}u(Wr,F);t(\"H.service.metaInfo.Service\",Wr);\nWr.prototype.ua={type:\"base\",version:\"newest\",subDomain:\"maps.ls\",path:\"maptile/2.1\",shards:[\"1\",\"2\",\"3\",\"4\"]};Wr.CONFIG_KEY=\"metaInfo\";n=Wr.prototype;n.Aa=function(a){a.subDomain&&this.B.za(a.subDomain);a.path&&this.B.lb(a.path);null!=a.useHTTPS&&this.B.Ai(a.useHTTPS?\"https\":\"http\")};n.qa=function(a,b,c){return(new qf(\"application/json\",a,ee,{headers:this.R})).then(b,function(d){c(Error(\"[\"+d.statusText+\"] \"+a+\" request failed\"))})};\nfunction Xr(a,b){for(var c={},d=a[b+\"s\"][b],e=d.length;e--;)c[d[e].id]=d[e];a[b+\"s\"]=c}n.Ja=function(){return this.B};n.ph=function(){return this.ec};n.Ej=function(){return this.Sa};n.Ac=function(){return this.fc};Wr.prototype.getVersion=Wr.prototype.Ac;Wr.prototype.Ci=function(a){this.fc=a};Wr.prototype.sa=function(){return this.Uc};Wr.prototype.getCopyrights=Wr.prototype.sa;\nWr.prototype.Ki=function(a){a=a.response;var b;Xr(a,\"map\");Xr(a,\"scheme\");Xr(a,\"tiletype\");Xr(a,\"format\");Xr(a,\"resolution\");Xr(a,\"language\");if(\"newest\"===this.fc&&\"traffic\"!==this.Sa)for(b in a.maps)a.maps[b].hash&&a.maps[b].newest&&(this.Ci(a.maps[b].hash),this.dispatchEvent(\"versionupdate\"));this.wh=a;this.dispatchEvent(\"infoupdate\")};\nWr.prototype.Zg=function(){var a=this;var b=this.B.clone().Y(\"info\").W({output:\"json\"});this.ec&&b.za(this.ec[0]);this.qa(b,function(c){a.Ki(c)},function(c){throw c;})};Wr.prototype.ih=function(){return this.wh};Wr.prototype.getInfo=Wr.prototype.ih;Wr.prototype.ve=function(a,b,c,d,e,f){return new Vr(this,d,{tileSize:a,pixelRatio:b,categoryFilter:c,tileType:e,scheme:f})};Wr.prototype.createTileProvider=Wr.prototype.ve;Wr.prototype.tc=function(a,b,c,d,e,f){return new bl(this.ve(a,b,c,d,e,f))};\nWr.prototype.createTileLayer=Wr.prototype.tc;X.prototype.yj=function(a){return this.sb(Wr,a)};X.prototype.getMetaInfoService=X.prototype.yj;(function(){var a=X.prototype.createDefaultLayers;X.prototype.createDefaultLayers=function(b,c,d,e,f,g){var h=a.call(this,b,c,d,e,f,g),k={},l=this.yj();\"object\"===typeof b&&(g=b,b=g.tileSize,c=g.ppi,d=g.lg,e=g.lg2,f=g.style,g=g.pois);b=b||256;var m=320===c?2:1;if(0>[72,250,320,500].indexOf(+c)){if(c!==B)throw new D(this.Qg,1,c);}else k.ppi=+c;d&&(k.lg=d);e&&(k.lg2=e);f&&(k.style=f);g&&(k.pois=g);h.raster.normal.metaInfo=l.tc(b,m,[\"buildings\"],k);return h}})();\n");